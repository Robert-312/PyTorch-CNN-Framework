<mxGraphModel grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="850" pageHeight="1100" background="#ffffff" dx="1451" dy="1107"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="2" value="&lt;div&gt;&lt;b&gt;groupby(&quot;InboxID&quot;)&lt;/b&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;SessionDuration&lt;/li&gt;&lt;li&gt;SendRequestSeconds&lt;/li&gt;&lt;li&gt;Click Count&lt;/li&gt;&lt;li&gt;Unique Link Count&lt;/li&gt;&lt;li&gt;Max IPBotScore&lt;/li&gt;&lt;li&gt;Max CIDRBotScore&lt;/li&gt;&lt;li&gt;Max ASNBotScore&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div align=&quot;left&quot;&gt;&lt;/div&gt;" parent="1" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;fillColor=#A9C4EB;" vertex="1"><mxGeometry as="geometry" height="140" width="225" x="112.5" y="670"/></mxCell><mxCell id="3" value="&lt;div&gt;&lt;b&gt;groupby(&quot;IPAddress&quot;)&lt;/b&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;ClickCount&lt;/li&gt;&lt;li&gt;UniqueInboxIDCount&lt;/li&gt;&lt;li&gt;UniqueUserIDCount&lt;/li&gt;&lt;li&gt;UniqueEmailComainCount&lt;/li&gt;&lt;li&gt;Unique&lt;span&gt;EmailRootLevelDomain&lt;/span&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;UniqueLinkCount&lt;br&gt;&lt;/li&gt;&lt;li&gt;SessionDuration&lt;/li&gt;&lt;li&gt;AvgSendRequestSeconds&lt;/li&gt;&lt;/ul&gt;&lt;div align=&quot;left&quot;&gt;&lt;/div&gt;" parent="1" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;fillColor=#FFB366;" vertex="1"><mxGeometry as="geometry" height="160" width="230" x="470" y="120"/></mxCell><mxCell id="19" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;fontSize=13;fontColor=#FFFFFF;" edge="1" source="4" target="3"><mxGeometry as="geometry" relative="1"/></mxCell><mxCell id="20" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;fontSize=13;fontColor=#FFFFFF;" edge="1" source="4" target="5"><mxGeometry as="geometry" relative="1"/></mxCell><mxCell id="21" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;fontSize=13;fontColor=#FFFFFF;" edge="1" source="4" target="6"><mxGeometry as="geometry" relative="1"/></mxCell><mxCell id="4" value="&lt;div align=&quot;center&quot;&gt;Original DF&lt;/div&gt;" parent="1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#000099;align=center;fontColor=#FFFFFF;fontSize=18;" vertex="1"><mxGeometry as="geometry" height="60" width="200" x="125" y="44"/></mxCell><mxCell id="23" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;fontSize=13;fontColor=#FFFFFF;" edge="1"><mxGeometry as="geometry" relative="1"><mxPoint as="sourcePoint" x="833.9832402234638" y="280"/><mxPoint as="targetPoint" x="831.5251396648045" y="300"/></mxGeometry></mxCell><mxCell id="5" value="&lt;div&gt;&lt;b&gt;groupby(&quot;CIDR Range&quot;)&lt;/b&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;ClickCount&lt;/li&gt;&lt;li&gt;UniqueInboxIDCount&lt;/li&gt;&lt;li&gt;UniqueUserIDCount&lt;/li&gt;&lt;li&gt;UniqueEmailComainCount&lt;/li&gt;&lt;li&gt;Unique&lt;span&gt;EmailRootLevelDomain&lt;/span&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;UniqueLinkCount&lt;br&gt;&lt;/li&gt;&lt;li&gt;SessionDuration&lt;/li&gt;&lt;li&gt;AvgSendRequestSeconds&lt;/li&gt;&lt;/ul&gt;&lt;div align=&quot;left&quot;&gt;&lt;/div&gt;" parent="1" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;fillColor=#FF9933;" vertex="1"><mxGeometry as="geometry" height="160" width="230" x="720" y="120"/></mxCell><mxCell id="6" value="&lt;div&gt;&lt;b&gt;groupby(&quot;AS Number&quot;)&lt;/b&gt;&lt;/div&gt;&lt;ul&gt;&lt;li&gt;ClickCount&lt;/li&gt;&lt;li&gt;UniqueInboxIDCount&lt;/li&gt;&lt;li&gt;UniqueUserIDCount&lt;/li&gt;&lt;li&gt;UniqueEmailComainCount&lt;/li&gt;&lt;li&gt;Unique&lt;span&gt;EmailRootLevelDomain&lt;/span&gt;&lt;br&gt;&lt;/li&gt;&lt;li&gt;UniqueLinkCount&lt;br&gt;&lt;/li&gt;&lt;li&gt;SessionDuration&lt;/li&gt;&lt;li&gt;AvgSendRequestSeconds&lt;/li&gt;&lt;/ul&gt;&lt;div align=&quot;left&quot;&gt;&lt;/div&gt;" parent="1" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;fillColor=#FF8000;" vertex="1"><mxGeometry as="geometry" height="160" width="230" x="970" y="120"/></mxCell><mxCell id="7" value="PCA / Unsupervised Clustering" parent="1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#663300;fontSize=18;fontColor=#FFFFFF;align=center;" vertex="1"><mxGeometry as="geometry" height="40" width="735" x="467.5" y="300"/></mxCell><mxCell id="25" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;jettySize=auto;orthogonalLoop=1;fontSize=13;fontColor=#FFFFFF;" edge="1" source="9"><mxGeometry as="geometry" relative="1"><mxPoint as="targetPoint" x="835" y="419"/></mxGeometry></mxCell><mxCell id="9" value="Manual Labeling of Clusters (BOT/NOT_BOT or BOT_SCORE)" parent="1" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#994C00;fontSize=18;fontColor=#FFFFFF;align=center;" vertex="1"><mxGeometry as="geometry" height="40" width="735" x="467.5" y="350"/></mxCell><mxCell id="28" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=1;entryY=0.5;jettySize=auto;orthogonalLoop=1;fontSize=13;fontColor=#FFFFFF;" edge="1" source="12" target="16"><mxGeometry as="geometry" relative="1"/></mxCell><mxCell id="12" value="df.&lt;span&gt;merge&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;df_IP[&quot;BotScore&quot;]&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;left_on&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;'IPAddress'&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;right_on&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;'&lt;span&gt;IPAddress'&lt;/span&gt;'&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;" parent="1" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fillColor=#00CC00;fontSize=18;fontColor=#FFFFFF;align=center;size=0.04251953125;" vertex="1"><mxGeometry as="geometry" height="28" width="725" x="472.50000000000005" y="420"/></mxCell><mxCell id="27" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=1;entryY=0.5;jettySize=auto;orthogonalLoop=1;fontSize=13;fontColor=#FFFFFF;" edge="1" source="13" target="17"><mxGeometry as="geometry" relative="1"/></mxCell><mxCell id="13" value="df.&lt;span&gt;merge&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;df_CIDR[&quot;BotScore&quot;]&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;left_on&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;'CIDR Range'&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;right_on&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;&quot;CIDR Range&quot;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;" parent="1" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fillColor=#009900;fontSize=18;fontColor=#FFFFFF;align=center;size=0.04251953125;" vertex="1"><mxGeometry as="geometry" height="28" width="725" x="472.50000000000005" y="458"/></mxCell><mxCell id="26" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=1;entryY=0.5;jettySize=auto;orthogonalLoop=1;fontSize=13;fontColor=#FFFFFF;" edge="1" source="14" target="15"><mxGeometry as="geometry" relative="1"/></mxCell><mxCell id="14" value="df.&lt;span&gt;merge&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;df_ASN[&quot;BotScore&quot;]&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;left_on&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;'AS Number'&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;right_on&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;'AS Number&lt;span&gt;'&lt;/span&gt;'&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;" parent="1" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fillColor=#006600;fontSize=18;fontColor=#FFFFFF;align=center;size=0.04251953125;" vertex="1"><mxGeometry as="geometry" height="28" width="725" x="472.50000000000005" y="495"/></mxCell><mxCell id="18" value="" parent="1" style="group" vertex="1" connectable="0"><mxGeometry as="geometry" height="101" width="315" x="125" y="525"/></mxCell><mxCell id="11" value="&lt;div align=&quot;center&quot;&gt;Original DF&lt;/div&gt;" parent="18" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#000099;align=center;fontColor=#FFFFFF;fontSize=18;" vertex="1"><mxGeometry as="geometry" height="90" width="200" y="11"/></mxCell><mxCell id="15" value="ASNBotScore" parent="18" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#006600;fontSize=12;fontColor=#FFFFFF;align=center;rotation=-90;" vertex="1"><mxGeometry as="geometry" height="20" width="90" x="225" y="46"/></mxCell><mxCell id="16" value="IPBotScore" parent="18" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#00CC00;fontSize=12;fontColor=#FFFFFF;align=center;rotation=-90;" vertex="1"><mxGeometry as="geometry" height="30" width="90" x="170" y="41"/></mxCell><mxCell id="17" value="CIDRBotScore" parent="18" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#009900;fontSize=12;fontColor=#FFFFFF;align=center;rotation=-90;" vertex="1"><mxGeometry as="geometry" height="30" width="90" x="200" y="41"/></mxCell><mxCell id="29" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=0;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;fontSize=12;fontColor=#FFFFFF;" edge="1" source="7" target="7"><mxGeometry as="geometry" relative="1"/></mxCell><mxCell id="30" parent="1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;jettySize=auto;orthogonalLoop=1;fontSize=12;fontColor=#FFFFFF;" edge="1" source="11" target="2"><mxGeometry as="geometry" relative="1"/></mxCell></root></mxGraphModel>